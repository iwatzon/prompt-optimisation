[tox]
skipsdist = True
envlist = py311
source_package = src/ai_ml_test
all_sources = {[tox]source_package} tests/


[testenv:provision]
envdir={toxworkdir}/.provision

[testenv]
description= Run tests
pip_version= pip>=21.3
allowlist_externals = poetry
deps =
    pytest

commands_pre =
    poetry install --no-ansi

commands =
    pytest {posargs}

[testenv:watch]
description= Run pytest-watch
pip_version= pip>=21.3
allowlist_externals = poetry
deps =
    pytest
    pytest-watch

commands_pre =
    poetry install --no-ansi

commands =
    ptw {posargs}
    
[testenv:lint]
basepython=python3.11
envdir = {toxworkdir}/py311
description = Run linting
deps =
    black
    black[jupyter]
    isort
    autoflake

commands=
    black {[tox]all_sources}
    autoflake {[tox]all_sources} -r --in-place --remove-all-unused-imports --remove-unused-variable
    isort --profile black {[tox]all_sources}

[testenv:debug]
basepython=python3.11
envdir = {toxworkdir}/py311
description = Run last failing tests and invoke debugger on errors
commands =
    pytest {posargs:--lf --pdb}
